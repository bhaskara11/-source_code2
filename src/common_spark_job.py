#!/usr/bin/env python

from pyspark.sql import SparkSession
from pyspark.sql.types import StructType, StructField, TimestampType, IntegerType, StringType, DoubleType, DateType, \
    LongType, BooleanType, ArrayType, DecimalType, FloatType
import sys


def _create_spark(spark_app_name):

    # Added int96RebaseModeInRead/Write property below, to address issue SPARK-31404 found for ACCT & PERS parquet file
    spark = SparkSession.builder \
        .appName(spark_app_name) \
        .config("spark.sql.legacy.parquet.int96RebaseModeInRead", "CORRECTED") \
        .config("spark.sql.legacy.parquet.int96RebaseModeInWrite", "CORRECTED") \
        .getOrCreate()
    return spark


def _get_schema(file_type):
    schema = ""
    if file_type == "badlogin_details":
        schema = StructType([StructField("EventDate", DateType(), True),
                             StructField("EventHour", LongType(), True),
                             StructField("EventDateTime", TimestampType(), True),
                             StructField("LoginID", StringType(), True),
                             StructField("Channel", StringType(), True),
                             StructField("BadLoginCount", LongType(), True),
                             StructField("FI_ID", StringType(), True)
                             ])

    elif file_type == "cloudflare_logs":
        schema = StructType([StructField("ProcessingTimestamp", TimestampType(), True),
                             StructField("BotScore", LongType(), True),
                             StructField("BotScoreSrc", StringType(), True),
                             StructField("CacheCacheStatus", StringType(), True),
                             StructField("CacheResponseBytes", LongType(), True),
                             StructField("CacheResponseStatus", LongType(), True),
                             StructField("CacheTieredFill", BooleanType(), True),
                             StructField("ClientASN", LongType(), True),
                             StructField("ClientCountry", StringType(), True),
                             StructField("ClientDeviceType", StringType(), True),
                             StructField("ClientIP", StringType(), True),
                             StructField("ClientIPClass", StringType(), True),
                             StructField("ClientRequestBytes", LongType(), True),
                             StructField("ClientRequestHost", StringType(), True),
                             StructField("ClientRequestMethod", StringType(), True),
                             StructField("ClientRequestPath", StringType(), True),
                             StructField("ClientRequestProtocol", StringType(), True),
                             StructField("ClientRequestReferer", StringType(), True),
                             StructField("ClientRequestURI", StringType(), True),
                             StructField("ClientRequestUserAgent", StringType(), True),
                             StructField("ClientSrcPort", LongType(), True),
                             StructField("ClientSSLCipher", StringType(), True),
                             StructField("ClientSSLProtocol", StringType(), True),
                             StructField("ClientXRequestedWith", StringType(), True),
                             StructField("EdgeColoCode", StringType(), True),
                             StructField("EdgeColoID", LongType(), True),
                             StructField("EdgeEndTimestamp", TimestampType(), True),
                             StructField("EdgePathingOp", StringType(), True),
                             StructField("EdgePathingSrc", StringType(), True),
                             StructField("EdgePathingStatus", StringType(), True),
                             StructField("EdgeRateLimitAction", StringType(), True),
                             StructField("EdgeRateLimitID", LongType(), True),
                             StructField("EdgeRequestHost", StringType(), True),
                             StructField("EdgeResponseBytes", LongType(), True),
                             StructField("EdgeResponseCompressionRatio", DoubleType(), True),
                             StructField("EdgeResponseContentType", StringType(), True),
                             StructField("EdgeResponseStatus", LongType(), True),
                             StructField("EdgeServerIP", StringType(), True),
                             StructField("EdgeStartTimestamp", TimestampType(), True),
                             StructField("FirewallMatchesActions", ArrayType(StringType(), True), True),
                             StructField("FirewallMatchesSources", ArrayType(StringType(), True), True),
                             StructField("FirewallMatchesRuleIDs", ArrayType(StringType(), True), True),
                             StructField("OriginIP", StringType(), True),
                             StructField("OriginResponseBytes", LongType(), True),
                             StructField("OriginResponseHTTPExpires", StringType(), True),
                             StructField("OriginResponseHTTPLastModified", StringType(), True),
                             StructField("OriginResponseStatus", LongType(), True),
                             StructField("OriginResponseTime", LongType(), True),
                             StructField("OriginSSLProtocol", StringType(), True),
                             StructField("RayID", StringType(), True),
                             StructField("ParentRayID", StringType(), True),
                             StructField("SecurityLevel", StringType(), True),
                             StructField("WAFAction", StringType(), True),
                             StructField("WAFFlags", LongType(), True),
                             StructField("WAFMatchedVar", StringType(), True),
                             StructField("WAFProfile", StringType(), True),
                             StructField("WAFRuleID", StringType(), True),
                             StructField("WAFRuleMessage", StringType(), True),
                             StructField("WorkerCPUTime", LongType(), True),
                             StructField("WorkerStatus", StringType(), True),
                             StructField("WorkerSubrequest", BooleanType(), True),
                             StructField("WorkerSubrequestCount", LongType(), True),
                             StructField("ZoneID", LongType(), True),
                             StructField("ZoneName", StringType(), True),
                             StructField("BotTags", ArrayType(StringType(), True), True),
                             StructField("ClientMTLSAuthCertFingerprint", StringType(), True),
                             StructField("ClientMTLSAuthStatus", StringType(), True),
                             StructField("ClientRequestScheme", StringType(), True),
                             StructField("ClientRequestSource", StringType(), True),
                             StructField("ClientTCPRTTMs", LongType(), True),
                             StructField("EdgeCFConnectingO2O", BooleanType(), True),
                             StructField("EdgeResponseBodyBytes", LongType(), True),
                             StructField("EdgeTimeToFirstByteMs", LongType(), True),
                             StructField("OriginDNSResponseTimeMs", LongType(), True),
                             StructField("OriginRequestHeaderSendDurationMs", LongType(), True),
                             StructField("OriginResponseDurationMs", LongType(), True),
                             StructField("OriginResponseHeaderReceiveDurationMs", LongType(), True),
                             StructField("OriginTCPHandshakeDurationMs", LongType(), True),
                             StructField("OriginTLSHandshakeDurationMs", LongType(), True),
                             StructField("SmartRouteColoID", LongType(), True),
                             StructField("UpperTierColoID", LongType(), True),
                             StructField("InstitutionId", StringType(), True)])

    elif file_type == "clickstreampageviewaggregate":
        schema = StructType([StructField("Channel", StringType(), True),
                             StructField("PageName", StringType(), True),
                             StructField("CustomerType", StringType(), True),
                             StructField("VisitDate", DateType(), True),
                             StructField("VisitHour", LongType(), True),
                             StructField("VisitDateTime", TimestampType(), True),
                             StructField("PageViewCount", LongType(), True),
                             StructField("FI_ID", StringType(), True)])

    elif file_type == "consolidatedproductpivot":
        schema = StructType([StructField("Member", StringType(), True),
                             StructField("Channel", StringType(), True),
                             StructField("Source", StringType(), True),
                             StructField("UserOS", DateType(), True),
                             StructField("CountyFIPSCode", LongType(), True),
                             StructField("StateName", TimestampType(), True),
                             StructField("ReqctxCustomerType", LongType(), True),
                             StructField("Product", StringType(), True),
                             StructField("IsMM", StringType(), True),
                             StructField("LoginFlag", StringType(), True),
                             StructField("ActiveUsers", StringType(), True),
                             StructField("Transactions", LongType(), True),
                             StructField("EventDate", DateType(), True),
                             StructField("FirstUse", DateType(), True),
                             StructField("Registration", DateType(), True),
                             StructField("Amount", DoubleType(), True),
                             StructField("FI_ID", StringType(), True)])

    elif file_type == "consolidateduserdim":
        schema = StructType([StructField("Member", StringType(), True),
                             StructField("Email", StringType(), True),
                             StructField("DigitalEnrollmentDate", TimestampType(), True),
                             StructField("DigitalActivityDate", TimestampType(), True),
                             StructField("MobileEnrollmentDate", TimestampType(), True),
                             StructField("MobileEnrollmentOS", StringType(), True),
                             StructField("MX_FirstUse", DateType(), True),
                             StructField("SavvyMoney_FirstUse", DateType(), True),
                             StructField("Alexa_FirstUse", DateType(), True),
                             StructField("PurchaseRewards_FirstUse", DateType(), True),
                             StructField("FreshDesk_FirstUse", DateType(), True),
                             StructField("Kasisto_FirstUse", DateType(), True),
                             StructField("LivePerson_FirstUse", DateType(), True),
                             StructField("Revation_FirstUse", DateType(), True),
                             StructField("CardManagement_FirstUse", DateType(), True),
                             StructField("FICO_FirstUse", DateType(), True),
                             StructField("SkipPayment_FirstUse", DateType(), True),
                             StructField("DigitalReceipt_FirstUse", DateType(), True),
                             StructField("EStatement_FirstUse", DateType(), True),
                             StructField("IpayBillPay_FirstUse", DateType(), True),
                             StructField("PayRailz_FirstUse", DateType(), True),
                             StructField("BBOnlineStatement_FirstUse", DateType(), True),
                             StructField("BBTPV_FirstUse", DateType(), True),
                             StructField("BBCheckPosPay_FirstUse", DateType(), True),
                             StructField("BBACHPosPay_FirstUse", DateType(), True),
                             StructField("CashEdge_FirstUse", DateType(), True),
                             StructField("RDC_FirstUse", DateType(), True),
                             StructField("Transfer_FirstUse", DateType(), True),
                             StructField("LoanPay_FirstUse", DateType(), True),
                             StructField("BillPay_FirstUse", DateType(), True),
                             StructField("Zelle_FirstUse", DateType(), True),
                             StructField("ACH_FirstUse", DateType(), True),
                             StructField("Wires_FirstUse", DateType(), True),
                             StructField("MX_Registration", DateType(), True),
                             StructField("SavvyMoney_Registration", DateType(), True),
                             StructField("Alexa_Registration", DateType(), True),
                             StructField("PurchaseRewards_Registration", DateType(), True),
                             StructField("FreshDesk_Registration", DateType(), True),
                             StructField("Kasisto_Registration", DateType(), True),
                             StructField("LivePerson_Registration", DateType(), True),
                             StructField("Revation_Registration", DateType(), True),
                             StructField("CardManagement_Registration", DateType(), True),
                             StructField("FICO_Registration", DateType(), True),
                             StructField("SkipPayment_Registration", DateType(), True),
                             StructField("DigitalReceipt_Registration", DateType(), True),
                             StructField("EStatement_Registration", DateType(), True),
                             StructField("BBOnlineStatement_Registration", DateType(), True),
                             StructField("BBTPV_Registration", DateType(), True),
                             StructField("BBCheckPosPay_Registration", DateType(), True),
                             StructField("BBACHPosPay_Registration", DateType(), True),
                             StructField("CashEdge_Registration", DateType(), True),
                             StructField("RDC_Registration", DateType(), True),
                             StructField("Transfer_Registration", DateType(), True),
                             StructField("LoanPay_Registration", DateType(), True),
                             StructField("BillPay_Registration", DateType(), True),
                             StructField("Zelle_Registration", DateType(), True),
                             StructField("IpayBillPay_Registration", DateType(), True),
                             StructField("PayRailz_Registration", DateType(), True),
                             StructField("ACH_Registration", DateType(), True),
                             StructField("Wires_Registration", DateType(), True),
                             StructField("FI_ID", StringType(), True)])

    elif file_type == "consolidatedvisitmetrics":
        schema = StructType([StructField("Channel", StringType(), True),
                             StructField("VisitState", StringType(), True),
                             StructField("CountyName", StringType(), True),
                             StructField("CountyFIPSCode", StringType(), True),
                             StructField("DeviceOS", StringType(), True),
                             StructField("BrowserName", StringType(), True),
                             StructField("MobileAppVersion", StringType(), True),
                             StructField("CustomerType", StringType(), True),
                             StructField("VisitDate", DateType(), True),
                             StructField("VisitHour", LongType(), True),
                             StructField("VisitDateTime", TimestampType(), True),
                             StructField("VisitLength", LongType(), True),
                             StructField("PageViewCount", LongType(), True),
                             StructField("UniquePageViewCount", LongType(), True),
                             StructField("VisitCount", LongType(), True),
                             StructField("FI_ID", StringType(), True)])

    elif file_type == "dw_bp_mth_fis":
        schema = StructType([StructField("cust_seq_nbr", StringType(), True),
                             StructField("extrl_cons_nbr", StringType(), True),
                             StructField("bill_dt", DateType(), True),
                             StructField("ssn", StringType(), True),
                             StructField("mem_nbr", StringType(), True),
                             StructField("cons_name", StringType(), True),
                             StructField("acct_nbr", StringType(), True),
                             StructField("prod_id", StringType(), True),
                             StructField("plan_type", StringType(), True),
                             StructField("cons_actvt_date", DateType(), True),
                             StructField("adt_crt_dtm", DateType(), True),
                             StructField("adt_upd_date", DateType(), True),
                             StructField("cons_sts_type", StringType(), True),
                             StructField("trxn_cnt", LongType(), True),
                             StructField("check_cnt", LongType(), True),
                             StructField("elect_cnt", LongType(), True),
                             StructField("xp_elect_cnt", LongType(), True),
                             StructField("rtrn_item_cnt", LongType(), True),
                             StructField("stop_pay_cnt", LongType(), True),
                             StructField("scanned_bills_cnt", LongType(), True),
                             StructField("scraped_bills_cnt", LongType(), True),
                             StructField("e_bills_cnt", LongType(), True),
                             StructField("check_copies_cnt", LongType(), True),
                             StructField("annl_cd_orders_cnt", LongType(), True),
                             StructField("research_items_cnt", LongType(), True),
                             StructField("xp_overnight_check_cnt", LongType(), True),
                             StructField("xp_card_pmt_cnt", LongType(), True),
                             StructField("platform", StringType(), True),
                             StructField("audit_key", LongType(), True),
                             StructField("audit_prmry_src", StringType(), True),
                             StructField("audit_ins_ts", DateType(), True),
                             StructField("audit_upd_ts", DateType(), True),
                             StructField("audit_upd_info", StringType(), True),
                             StructField("FI_ID", StringType(), True)])

    elif file_type == "dw_bp_mth_fiserv":
        schema = StructType([StructField("csp_id", StringType(), True),
                             StructField("subscriber_id", StringType(), True),
                             StructField("dw_bill_date", DateType(), True),
                             StructField("mem_number", StringType(), True),
                             StructField("dw_product_id", StringType(), True),
                             StructField("subscriber_type", StringType(), True),
                             StructField("business_name", StringType(), True),
                             StructField("last_name", StringType(), True),
                             StructField("first_name", StringType(), True),
                             StructField("middle_name", StringType(), True),
                             StructField("nickname", StringType(), True),
                             StructField("subscriber_name_prefix", StringType(), True),
                             StructField("tax_id", StringType(), True),
                             StructField("subscriber_dob", StringType(), True),
                             StructField("address_line_1", StringType(), True),
                             StructField("address_line_2", StringType(), True),
                             StructField("address_line_3", StringType(), True),
                             StructField("city", StringType(), True),
                             StructField("state", StringType(), True),
                             StructField("zip_5", StringType(), True),
                             StructField("zip_4", StringType(), True),
                             StructField("zip_2", StringType(), True),
                             StructField("country_code", StringType(), True),
                             StructField("postal_code", StringType(), True),
                             StructField("province_name", StringType(), True),
                             StructField("day_phone", StringType(), True),
                             StructField("evening_phone", StringType(), True),
                             StructField("fax_phone", StringType(), True),
                             StructField("enrollment_form_code", StringType(), True),
                             StructField("enrollment_marketing_source", StringType(), True),
                             StructField("client_specification_id", StringType(), True),
                             StructField("client_specification_version", StringType(), True),
                             StructField("product_code", StringType(), True),
                             StructField("time_zone", StringType(), True),
                             StructField("e_mail_address", StringType(), True),
                             StructField("subscriber_category", StringType(), True),
                             StructField("employee_indicator", StringType(), True),
                             StructField("draft_only_indicator", StringType(), True),
                             StructField("fulfillment_code", StringType(), True),
                             StructField("billing_class", StringType(), True),
                             StructField("service_code", StringType(), True),
                             StructField("solicitation_flag", StringType(), True),
                             StructField("subscriber_status", StringType(), True),
                             StructField("external_id", StringType(), True),
                             StructField("external_id2", StringType(), True),
                             StructField("add_date", DateType(), True),
                             StructField("inactivation_date", DateType(), True),
                             StructField("date_last_updated", DateType(), True),
                             StructField("date_of_last_status_change", DateType(), True),
                             StructField("last_connection_date", DateType(), True),
                             StructField("billing_category", StringType(), True),
                             StructField("last_payment_date", DateType(), True),
                             StructField("fee_tier_8050", StringType(), True),
                             StructField("nbr_pmt", LongType(), True),
                             StructField("nbr_electronic_pmt", LongType(), True),
                             StructField("nbr_paper_pmt", LongType(), True),
                             StructField("amt_pmt", DecimalType(), True),
                             StructField("amt_electronic_pmt", DecimalType(), True),
                             StructField("amt_paper_pmt", DecimalType(), True),
                             StructField("nbr_canceled_pmt", LongType(), True),
                             StructField("nbr_one_time_pmt", LongType(), True),
                             StructField("nbr_recurring_pmt", LongType(), True),
                             StructField("pmt_allowance", LongType(), True),
                             StructField("excess_pmt", LongType(), True),
                             StructField("amt_one_time_pmt", DecimalType(), True),
                             StructField("amt_recurring_pmt", DecimalType(), True),
                             StructField("pending_pmt_ind", StringType(), True),
                             StructField("active_recurring_model_ind", StringType(), True),
                             StructField("promotion_code", StringType(), True),
                             StructField("nbr_promotional_credits", LongType(), True),
                             StructField("amt_promotional_credits", DecimalType(), True),
                             StructField("transaction_type", StringType(), True),
                             StructField("nbr_declined_pmt", LongType(), True),
                             StructField("amt_declined_pmt", DecimalType(), True),
                             StructField("nbr_recurring_declined_pmt", LongType(), True),
                             StructField("amt_recurring_declined_pmt", DecimalType(), True),
                             StructField("nbr_same_day_pmt", LongType(), True),
                             StructField("amt_same_day_pmt", DecimalType(), True),
                             StructField("nbr_next_day_pmt", LongType(), True),
                             StructField("amt_next_day_pmt", DecimalType(), True),
                             StructField("nbr_overnight_pmt", LongType(), True),
                             StructField("amt_overnight_pmt", DecimalType(), True),
                             StructField("nbr_sameday_ebp_pmt", LongType(), True),
                             StructField("amt_sameday_ebp_pmt", DecimalType(), True),
                             StructField("nbr_widget_pmt", LongType(), True),
                             StructField("amt_widget_pmt", DecimalType(), True),
                             StructField("fee_tier_8054", StringType(), True),
                             StructField("nbr_a2a_int_to_int_transfer", LongType(), True),
                             StructField("amt_a2a_int_to_int_transfer", DecimalType(), True),
                             StructField("nbr_a2a_int_to_ext_transfer", LongType(), True),
                             StructField("amt_a2a_int_to_ext_transfer", DecimalType(), True),
                             StructField("nbr_a2a_ext_to_int_transfer", LongType(), True),
                             StructField("amt_a2a_ext_to_int_transfer", DecimalType(), True),
                             StructField("nbr_a2a_ext_to_ext_transfer", LongType(), True),
                             StructField("amt_a2a_ext_to_ext_transfer", DecimalType(), True),
                             StructField("nbr_emails", LongType(), True),
                             StructField("nbr_banking_emails", LongType(), True),
                             StructField("nbr_bill_payment_emails", LongType(), True),
                             StructField("amt_service_fees", DecimalType(), True),
                             StructField("amt_basic_service_fees", DecimalType(), True),
                             StructField("amt_excess_service_fees", DecimalType(), True),
                             StructField("amt_overnight_check_fees", DecimalType(), True),
                             StructField("amt_same_day_ebp_fees", DecimalType(), True),
                             StructField("basic_serv_fee_db_cr_ind", StringType(), True),
                             StructField("amt_a2a_internal_fees", DecimalType(), True),
                             StructField("amt_a2a_external_fees", DecimalType(), True),
                             StructField("excess_serv_fee_db_cr_ind", StringType(), True),
                             StructField("amt_egreetings_fees", DecimalType(), True),
                             StructField("nbr_users", LongType(), True),
                             StructField("audit_key", LongType(), True),
                             StructField("audit_prmry_src", StringType(), True),
                             StructField("audit_ins_ts", DateType(), True),
                             StructField("audit_upd_ts", DateType(), True),
                             StructField("audit_upd_info", StringType(), True),
                             StructField("FI_ID", StringType(), True)])

    elif file_type == "firewallsummarymetrics":
        schema = StructType([StructField("EventDate", DateType(), True),
                             StructField("EventHour", LongType(), True),
                             StructField("EventDateTime", StringType(), True),
                             StructField("ClientIP", StringType(), True),
                             StructField("ClientRequestUserAgent", StringType(), True),
                             StructField("ClientRequestURI", StringType(), True),
                             StructField("ClientCountry", StringType(), True),
                             StructField("ClientRequestHost", StringType(), True),
                             StructField("ClientASN", LongType(), True),
                             StructField("ClientRequestMethod", StringType(), True),
                             StructField("FirewallMatchesSources", StringType(), True),
                             StructField("FirewallMatchesActions", StringType(), True),
                             StructField("FirewallRuleName", StringType(), True),
                             StructField("FirewallMatchesRuleIDs", StringType(), True),
                             StructField("total_requests", LongType(), True),
                             StructField("AllowRequests", LongType(), True),
                             StructField("LogRequests", LongType(), True),
                             StructField("SimulateRequests", LongType(), True),
                             StructField("BlockRequests", LongType(), True),
                             StructField("ChallengeRequests", LongType(), True),
                             StructField("JSChallengeRequests", LongType(), True),
                             StructField("ConnectionCloseRequests", LongType(), True),
                             StructField("BypassRequests", LongType(), True),
                             StructField("ChallengeSolved", LongType(), True),
                             StructField("ChallengeFailed", LongType(), True),
                             StructField("ChallengeBypassed", LongType(), True),
                             StructField("JSChallengeSolved", LongType(), True),
                             StructField("JSChallengeFailed", LongType(), True),
                             StructField("JSChallengeBypassed", LongType(), True),
                             StructField("ManagedChallenge", LongType(), True),
                             StructField("ManagedChallengeSkipped", LongType(), True),
                             StructField("ManagedChallengeNonInteractiveSolved", LongType(), True),
                             StructField("ManagedChallengeInteractiveSolved", LongType(), True),
                             StructField("ManagedChallengeBypassed", LongType(), True),
                             StructField("ASNRequests", LongType(), True),
                             StructField("CountryRequests", LongType(), True),
                             StructField("IPRequests", LongType(), True),
                             StructField("IPRangeRequests", LongType(), True),
                             StructField("SecurityLevelRequests", LongType(), True),
                             StructField("ZoneLockdownRequests", LongType(), True),
                             StructField("WAFRequests", LongType(), True),
                             StructField("FirewallRulesRequests", LongType(), True),
                             StructField("UABlockRequests", LongType(), True),
                             StructField("RateLimitRequests", LongType(), True),
                             StructField("BicRequests", LongType(), True),
                             StructField("HotRequests", LongType(), True),
                             StructField("l7ddosRequests", LongType(), True),
                             StructField("SanityCheckRequests", LongType(), True),
                             StructField("ProtectRequests", LongType(), True),
                             StructField("FI_ID", StringType(), True)])

    elif file_type == "rpt_user_profile":
        schema = StructType([StructField("mem_nbr", StringType(), True),
                             StructField("mem_name", StringType(), True),
                             StructField("alt_mem_nbr", StringType(), True),
                             StructField("prdct_user_guid", StringType(), True),
                             StructField("bp_userid", StringType(), True),
                             StructField("cis", StringType(), True),
                             StructField("mem_cmpny_name", StringType(), True),
                             StructField("email_address", StringType(), True),
                             StructField("olb_reg_dt", StringType(), True),
                             StructField("olb_last_login_dt", StringType(), True),
                             StructField("olb_first_login_dt", StringType(), True),
                             StructField("pwd_chng_dt", StringType(), True),
                             StructField("dsclsr_accptd_dt", StringType(), True),
                             StructField("dsclsr_rejctd_dt", StringType(), True),
                             StructField("hold_dt", StringType(), True),
                             StructField("hold_desc", StringType(), True),
                             StructField("os_dsclsr_dt", StringType(), True),
                             StructField("esign_dt", StringType(), True),
                             StructField("last_trnsf_dt", StringType(), True),
                             StructField("last_sms_dt", StringType(), True),
                             StructField("last_alrt_dt", StringType(), True),
                             StructField("last_srt_dt", StringType(), True),
                             StructField("olb_login_cnt", LongType(), True),
                             StructField("olb_bad_login_cnt", LongType(), True),
                             StructField("sts_active_flg", StringType(), True),
                             StructField("sts_new_flg", StringType(), True),
                             StructField("sts_on_hold_flg", StringType(), True),
                             StructField("sts_locked_flg", StringType(), True),
                             StructField("sts_accptd_dsclsr_flg", StringType(), True),
                             StructField("sts_billpay_flg", StringType(), True),
                             StructField("sts_needs_dsclsr_flg", StringType(), True),
                             StructField("sts_must_change_pwd_flg", StringType(), True),
                             StructField("sts_invalid_email_flg", StringType(), True),
                             StructField("sts_must_change_userid_flg", StringType(), True),
                             StructField("sts_needs_new_dsclsr_flg", StringType(), True),
                             StructField("sts_bp_frontpg_pendpay_flg", StringType(), True),
                             StructField("sts_fi_approved_flg", StringType(), True),
                             StructField("sts_fi_approval_pndng_flg", StringType(), True),
                             StructField("sts_reset_flg", StringType(), True),
                             StructField("sts_mfa_enrlld_cookie_flg", StringType(), True),
                             StructField("sts_mfa_mandatory_flg", StringType(), True),
                             StructField("sts_mfa_optional_flg", StringType(), True),
                             StructField("sts_inquiry_only_flg", StringType(), True),
                             StructField("sts_bp_optout_flg", StringType(), True),
                             StructField("sts_sms_enrlld_flg", StringType(), True),
                             StructField("sts_sms_confirmed_flg", StringType(), True),
                             StructField("sts_isso_user_enrlld_flg", StringType(), True),
                             StructField("sts_reset_isso_enrlld_flg", StringType(), True),
                             StructField("sts_entitlements_flg", StringType(), True),
                             StructField("sts_email_mfa_enrlld_flg", StringType(), True),
                             StructField("sts_fp_email_offrd_flg", StringType(), True),
                             StructField("sts_fp_voice_offrd_flg", StringType(), True),
                             StructField("sts_fp_sms_offrd_flg", StringType(), True),
                             StructField("sts_fp_cq_offrd_flg", StringType(), True),
                             StructField("sts_esign_flg", StringType(), True),
                             StructField("sts_bp_dsclsr_accptd", StringType(), True),
                             StructField("os_paper_stmnt_flg", StringType(), True),
                             StructField("os_email_reminder_flg", StringType(), True),
                             StructField("os_dsclsr_flg", StringType(), True),
                             StructField("os_email_reminder_dt", StringType(), True),
                             StructField("ols_email_addr", StringType(), True),
                             StructField("orig_esign_acpt_dt", StringType(), True),
                             StructField("orig_esign_rej_dt", StringType(), True),
                             StructField("updtd_esign_acpt_dt", StringType(), True),
                             StructField("updtd_esign_reg_dt", StringType(), True),
                             StructField("orig_sms_alert_acp_date", StringType(), True),
                             StructField("orig_sms_alert_rej_date", StringType(), True),
                             StructField("updated_sms_alert_acp_date", StringType(), True),
                             StructField("updated_sms_alert_rej_date", StringType(), True),
                             StructField("do_not_sell_acp_flg", StringType(), True),
                             StructField("do_not_sell_acp_date", StringType(), True),
                             StructField("do_not_sell_rej_date", StringType(), True),
                             StructField("news_opt_out_flg", StringType(), True),
                             StructField("promo_opt_out_flg", StringType(), True),
                             StructField("dw_mem_crc32", LongType(), True),
                             StructField("cmpny_name", StringType(), True),
                             StructField("last_activity_dt", StringType(), True),
                             StructField("iphone_dsclsr_accptd_dt", StringType(), True),
                             StructField("iphone_last_actvty_dt", StringType(), True),
                             StructField("andrd_dsclsr_accptd_dt", StringType(), True),
                             StructField("andrd_last_actvty_dt", StringType(), True),
                             StructField("ipad_dsclsr_accptd_dt", StringType(), True),
                             StructField("ipad_last_actvty_dt", StringType(), True),
                             StructField("amzntbl_dsclsr_accptd_dt", StringType(), True),
                             StructField("amzntbl_last_actvty_dt", StringType(), True),
                             StructField("andrdtbl_dsclsr_accptd_dt", StringType(), True),
                             StructField("andrdtbl_last_actvty_dt", StringType(), True),
                             StructField("amznbk_dsclsr_accptd_dt", StringType(), True),
                             StructField("amznbk_last_actvty_dt", StringType(), True),
                             StructField("iphone_first_actvty_dt", StringType(), True),
                             StructField("andrd_first_actvty_dt", StringType(), True),
                             StructField("ipad_first_actvty_dt", StringType(), True),
                             StructField("amzntbl_first_actvty_dt", StringType(), True),
                             StructField("andrdtbl_first_actvty_dt", StringType(), True),
                             StructField("mblweb_first_actvty_dt", StringType(), True),
                             StructField("amznbk_first_actvty_dt", StringType(), True),
                             StructField("rdc_first_activity_dt", StringType(), True),
                             StructField("rdc_last_activity_dt", StringType(), True),
                             StructField("applewatch_last_actvty_dt", StringType(), True),
                             StructField("applewatch_acptd_dsclsr_dt", StringType(), True),
                             StructField("andrdwear_last_actvty_dt", StringType(), True),
                             StructField("andrdwear_acptd_dsclsr_dt", StringType(), True),
                             StructField("apisdk_last_actvty_dt", StringType(), True),
                             StructField("apisdk_acptd_dsclsr_dt", StringType(), True),
                             StructField("applewatch_first_actvty_dt", StringType(), True),
                             StructField("andrdwear_first_actvty_dt", StringType(), True),
                             StructField("apisdk_first_actvty_dt", StringType(), True),
                             StructField("alexa_first_actvty_dt", StringType(), True),
                             StructField("alexa_last_actvty_dt", StringType(), True),
                             StructField("alexa_reg_dt", StringType(), True),
                             StructField("fw_dsclsr_accptd_dt", StringType(), True),
                             StructField("sms_first_sign_up_dt", StringType(), True),
                             StructField("sms_last_sign_up_dt", StringType(), True),
                             StructField("sms_last_stop_dt", StringType(), True),
                             StructField("last_bp_act_date", StringType(), True),
                             StructField("dup_email_flg", StringType(), True),
                             StructField("forgot_pwd_dt", StringType(), True),
                             StructField("mblweb_last_actvty_dt", StringType(), True),
                             StructField("mfa_dsclsr_accptd_dt", StringType(), True),
                             StructField("mfa_last_actvty_dt", StringType(), True),
                             StructField("fw_last_actvty_dt", StringType(), True),
                             StructField("sts_usp_enrlld_flg", StringType(), True),
                             StructField("sts_mfa_active", StringType(), True),
                             StructField("sts_mfa_enrlld_voice", StringType(), True),
                             StructField("sts_mfa_enrlld_sms", StringType(), True),
                             StructField("sts_mfa_enrlld_email", StringType(), True),
                             StructField("sts_fw_active", StringType(), True),
                             StructField("prmry_usr_dsclsr_accptd_dt", StringType(), True),
                             StructField("prmry_usr_dsclsr_accptd_flg", StringType(), True),
                             StructField("prmry_usr_add_subusr_acct_flg", StringType(), True),
                             StructField("prmry_usr_add_subusr_acct_dt", StringType(), True),
                             StructField("sub_usr_dsclsr_accptd_dt", StringType(), True),
                             StructField("sub_usr_dsclsr_accptd_flg", StringType(), True),
                             StructField("sub_usr_last_login_dt", StringType(), True),
                             StructField("sub_usr_sts", StringType(), True),
                             StructField("mfa_voice_phone_nbr", StringType(), True),
                             StructField("mfa_sms_phone_nbr", StringType(), True),
                             StructField("mfa_voice_phone_nbr1", StringType(), True),
                             StructField("mfa_sms_phone_nbr1", StringType(), True),
                             StructField("mfa_voice_phone_nbr2", StringType(), True),
                             StructField("mfa_sms_phone_nbr2", StringType(), True),
                             StructField("mfa_voice_phone_nbr3", StringType(), True),
                             StructField("mfa_sms_phone_nbr3", StringType(), True),
                             StructField("mfa_voice_phone_nbr4", StringType(), True),
                             StructField("mfa_sms_phone_nbr4", StringType(), True),
                             StructField("mfa_email_addr", StringType(), True),
                             StructField("dly_bp_ebills_flg", StringType(), True),
                             StructField("dly_bp_schdld_pmt_dt", StringType(), True),
                             StructField("dly_bp_recur_pmt_flg", StringType(), True),
                             StructField("last_bp_enrollment_dt", StringType(), True),
                             StructField("last_biometric_login_dt", StringType(), True),
                             StructField("last_export_dt", StringType(), True),
                             StructField("last_sec_supt_chat_dt", StringType(), True),
                             StructField("last_savvy_money_act_dt", StringType(), True),
                             StructField("totp_enabled_flag", StringType(), True),
                             StructField("totp_enabled_date", StringType(), True),
                             StructField("first_name", StringType(), True),
                             StructField("last_name", StringType(), True),
                             StructField("sms_country_code", StringType(), True),
                             StructField("mem_deleted_flg", StringType(), True),
                             StructField("mem_deleted_dt", StringType(), True),
                             StructField("audit_key", LongType(), True),
                             StructField("audit_prmry_src", StringType(), True),
                             StructField("audit_ins_ts", StringType(), True),
                             StructField("audit_upd_ts", StringType(), True),
                             StructField("audit_upd_info", StringType(), True),
                             StructField("FI_ID", StringType(), True)])

    elif file_type == "securityfirewallrulemetrics":
        schema = StructType([StructField("EventDate", DateType(), True),
                             StructField("EventDateTime", StringType(), True),
                             StructField("FirewallRuleName", StringType(), True),
                             StructField("FirewallMatchesRuleIDs", StringType(), True),
                             StructField("ClientRequestHost", StringType(), True),
                             StructField("event_count", LongType(), True),
                             StructField("FI_ID", StringType(), True)
                             ])

    elif file_type == "securityipaddressmetrics":
        schema = StructType([StructField("EventDate", DateType(), True),
                             StructField("EventDateTime", StringType(), True),
                             StructField("ClientIP", StringType(), True),
                             StructField("ClientRequestHost", StringType(), True),
                             StructField("event_count", LongType(), True),
                             StructField("FI_ID", StringType(), True)])

    elif file_type == "securitysummarymetrics":
        schema = StructType([StructField("EventDate", DateType(), True),
                             StructField("EventHour", LongType(), True),
                             StructField("EventDateTime", StringType(), True),
                             StructField("ClientRequestHost", StringType(), True),
                             StructField("BadBotCount", LongType(), True),
                             StructField("cached_events", LongType(), True),
                             StructField("non_cached_events", LongType(), True),
                             StructField("blocked_events", LongType(), True),
                             StructField("challenged_events", LongType(), True),
                             StructField("general_events", LongType(), True),
                             StructField("rate_limit_actions", LongType(), True),
                             StructField("event_count", LongType(), True),
                             StructField("FI_ID", StringType(), True)])

    elif file_type == "system_banking_activity":
        schema = StructType([StructField("timestamp", TimestampType(), True),
                             StructField("eventid", StringType(), True),
                             StructField("eventtype", StringType(), True),
                             StructField("member", StringType(), True),
                             StructField("absrunid", StringType(), True),
                             StructField("subscriptionid", StringType(), True),
                             StructField("subscriptiontype", StringType(), True),
                             StructField("accountid", StringType(), True),
                             StructField("threshold", StringType(), True),
                             StructField("startdate", StringType(), True),
                             StructField("enddate", StringType(), True),
                             StructField("frequency", StringType(), True),
                             StructField("lifetype", StringType(), True),
                             StructField("checkid", StringType(), True),
                             StructField("checkstatus", StringType(), True),
                             StructField("alertstatus", StringType(), True),
                             StructField("executestatus", StringType(), True),
                             StructField("apitype", StringType(), True),
                             StructField("apistatus", StringType(), True),
                             StructField("apirequest", StringType(), True),
                             StructField("apimessage", StringType(), True),
                             StructField("retrycount", StringType(), True),
                             StructField("duration", StringType(), True),
                             StructField("httpmethod", StringType(), True),
                             StructField("httpurl", StringType(), True),
                             StructField("httpstatus", StringType(), True),
                             StructField("message", StringType(), True),
                             StructField("absruntype", StringType(), True),
                             StructField("absrunevent", StringType(), True),
                             StructField("absruntime", StringType(), True),
                             StructField("pagecount", StringType(), True),
                             StructField("usercount", StringType(), True),
                             StructField("subscriptioncount", StringType(), True),
                             StructField("absusertype", StringType(), True),
                             StructField("guid", StringType(), True),
                             StructField("reqctx_appid", StringType(), True),
                             StructField("reqctx_id", StringType(), True),
                             StructField("reqctx_bcid", StringType(), True),
                             StructField("reqctx_bcindex", StringType(), True),
                             StructField("reqctx_country", StringType(), True),
                             StructField("reqctx_userproduct", StringType(), True),
                             StructField("reqctx_userproductversion", StringType(), True),
                             StructField("reqctx_ipaddress", StringType(), True),
                             StructField("reqctx_locale", StringType(), True),
                             StructField("reqctx_offeringid", StringType(), True),
                             StructField("reqctx_region", StringType(), True),
                             StructField("reqctx_sessionid", StringType(), True),
                             StructField("reqctx_userid", StringType(), True),
                             StructField("reqctx_hostname", StringType(), True),
                             StructField("reqctx_timezone", StringType(), True),
                             StructField("reqctx_tzoffset", StringType(), True),
                             StructField("processingtime", TimestampType(), True),
                             StructField("reqctx_canonicalid", StringType(), True)])

    elif file_type == "totalusers":
        schema = StructType([StructField("EventDate", DateType(), True),
                             StructField("ReqctxCustomerType", StringType(), True),
                             StructField("TotalUsers_Daily", LongType(), True),
                             StructField("TotalUsers_Weekly", LongType(), True),
                             StructField("TotalUsers_Monthly", LongType(), True),
                             StructField("TotalUsers_Quarter", LongType(), True),
                             StructField("FI_ID", StringType(), True)])

    elif file_type == "user_banking_activity":
        schema = StructType([StructField("type", StringType(), True),
                             StructField("timestamp", TimestampType(), True),
                             StructField("eventdate", DateType(), True),
                             StructField("accepted", StringType(), True),
                             StructField("accessmethod", StringType(), True),
                             StructField("accesspoint", StringType(), True),
                             StructField("accountdescription", StringType(), True),
                             StructField("accountnumber", StringType(), True),
                             StructField("accounttype", StringType(), True),
                             StructField("action", StringType(), True),
                             StructField("actionstatus", StringType(), True),
                             StructField("actiontaken", StringType(), True),
                             StructField("address1", StringType(), True),
                             StructField("address2", StringType(), True),
                             StructField("addstock", StringType(), True),
                             StructField("alert", StringType(), True),
                             StructField("altid", StringType(), True),
                             StructField("amount", StringType(), True),
                             StructField("attempts", StringType(), True),
                             StructField("billpaymentid", StringType(), True),
                             StructField("billpaymentupdate", StringType(), True),
                             StructField("bppending", StringType(), True),
                             StructField("bpsponscons", StringType(), True),
                             StructField("bptransactionid", StringType(), True),
                             StructField("bptransactiontype", StringType(), True),
                             StructField("bpverrormessage", StringType(), True),
                             StructField("bpvname", StringType(), True),
                             StructField("cardexpirationdate", StringType(), True),
                             StructField("cardnumber", StringType(), True),
                             StructField("cardowner", StringType(), True),
                             StructField("cardtype", StringType(), True),
                             StructField("cdaccountnumber", StringType(), True),
                             StructField("challengequestions", StringType(), True),
                             StructField("challengerequired", StringType(), True),
                             StructField("challengestatus", StringType(), True),
                             StructField("challengestep", StringType(), True),
                             StructField("challengetype", StringType(), True),
                             StructField("checknumber", StringType(), True),
                             StructField("city", StringType(), True),
                             StructField("client", StringType(), True),
                             StructField("combinedenrollment", StringType(), True),
                             StructField("comment", StringType(), True),
                             StructField("comments", StringType(), True),
                             StructField("companyname", StringType(), True),
                             StructField("completionnotification", StringType(), True),
                             StructField("completionstatus", StringType(), True),
                             StructField("computerenrolled", StringType(), True),
                             StructField("confno", StringType(), True),
                             StructField("crossmember", StringType(), True),
                             StructField("customamount", StringType(), True),
                             StructField("data", StringType(), True),
                             StructField("date", StringType(), True),
                             StructField("delaysremaining", StringType(), True),
                             StructField("depositaccountnumber", StringType(), True),
                             StructField("disabled", StringType(), True),
                             StructField("distatus", StringType(), True),
                             StructField("due", StringType(), True),
                             StructField("email", StringType(), True),
                             StructField("enddate", StringType(), True),
                             StructField("endsequence", StringType(), True),
                             StructField("enrollmentselected", StringType(), True),
                             StructField("enrollmentstatus", StringType(), True),
                             StructField("errormessage", StringType(), True),
                             StructField("euselection", StringType(), True),
                             StructField("eventid", StringType(), True),
                             StructField("eventtype", StringType(), True),
                             StructField("exampleentry", StringType(), True),
                             StructField("failurereason", StringType(), True),
                             StructField("fee", StringType(), True),
                             StructField("fieldmodified", StringType(), True),
                             StructField("firelationship", StringType(), True),
                             StructField("fistatus", StringType(), True),
                             StructField("format", StringType(), True),
                             StructField("frequency", StringType(), True),
                             StructField("fromaccount", StringType(), True),
                             StructField("fromaccounttype", StringType(), True),
                             StructField("fromroutingnumber", StringType(), True),
                             StructField("fundingaccountnumber", StringType(), True),
                             StructField("fundingamount", StringType(), True),
                             StructField("hosterrormessage", StringType(), True),
                             StructField("hostresponsecode", StringType(), True),
                             StructField("idsent", StringType(), True),
                             StructField("issuedate", StringType(), True),
                             StructField("locked", StringType(), True),
                             StructField("maxattempts", StringType(), True),
                             StructField("member", StringType(), True),
                             StructField("memo", StringType(), True),
                             StructField("messagenumber", StringType(), True),
                             StructField("messagetext", StringType(), True),
                             StructField("mfaenrolled", StringType(), True),
                             StructField("mfastatus", StringType(), True),
                             StructField("newacctnumber", StringType(), True),
                             StructField("newaddr", StringType(), True),
                             StructField("newbpemail", StringType(), True),
                             StructField("newemail", StringType(), True),
                             StructField("newfirstname", StringType(), True),
                             StructField("newid", StringType(), True),
                             StructField("newlastname", StringType(), True),
                             StructField("newphone1", StringType(), True),
                             StructField("newphone2", StringType(), True),
                             StructField("newproductcode", StringType(), True),
                             StructField("newvalue", StringType(), True),
                             StructField("nickname", StringType(), True),
                             StructField("oldaddr", StringType(), True),
                             StructField("oldbpemail", StringType(), True),
                             StructField("oldemail", StringType(), True),
                             StructField("oldfirstname", StringType(), True),
                             StructField("oldid", StringType(), True),
                             StructField("oldlastname", StringType(), True),
                             StructField("oldphone1", StringType(), True),
                             StructField("oldphone2", StringType(), True),
                             StructField("oldvalue", StringType(), True),
                             StructField("pagenumber", StringType(), True),
                             StructField("paperstatement", StringType(), True),
                             StructField("passcodesent", StringType(), True),
                             StructField("passwordupdate", StringType(), True),
                             StructField("payeeid", StringType(), True),
                             StructField("payeename", StringType(), True),
                             StructField("payment", StringType(), True),
                             StructField("paymenttype", StringType(), True),
                             StructField("permissions", StringType(), True),
                             StructField("phoneoremail", StringType(), True),
                             StructField("phonenumber", StringType(), True),
                             StructField("presentationno", StringType(), True),
                             StructField("processdate", StringType(), True),
                             StructField("product", StringType(), True),
                             StructField("promoname", StringType(), True),
                             StructField("promptname", StringType(), True),
                             StructField("reason", StringType(), True),
                             StructField("reference", StringType(), True),
                             StructField("reissue", StringType(), True),
                             StructField("reportnumber", StringType(), True),
                             StructField("reqctx_appid", StringType(), True),
                             StructField("reqctx_bcid", StringType(), True),
                             StructField("reqctx_bcindex", StringType(), True),
                             StructField("reqctx_callinghost", StringType(), True),
                             StructField("reqctx_community", StringType(), True),
                             StructField("reqctx_companyid", StringType(), True),
                             StructField("reqctx_featurename", StringType(), True),
                             StructField("reqctx_fepid", StringType(), True),
                             StructField("reqctx_hostname", StringType(), True),
                             StructField("reqctx_id", StringType(), True),
                             StructField("reqctx_iddomain", StringType(), True),
                             StructField("reqctx_intuit_country", StringType(), True),
                             StructField("reqctx_ipaddress", StringType(), True),
                             StructField("reqctx_locale", StringType(), True),
                             StructField("reqctx_loginid", StringType(), True),
                             StructField("reqctx_offeringid", StringType(), True),
                             StructField("reqctx_onbehalfof", StringType(), True),
                             StructField("reqctx_onbehalfofuser", StringType(), True),
                             StructField("reqctx_region", StringType(), True),
                             StructField("reqctx_requesturi", StringType(), True),
                             StructField("reqctx_sessionid", StringType(), True),
                             StructField("reqctx_test", StringType(), True),
                             StructField("reqctx_timezone", StringType(), True),
                             StructField("reqctx_transid", StringType(), True),
                             StructField("reqctx_tzoffset", StringType(), True),
                             StructField("reqctx_useragent", StringType(), True),
                             StructField("reqctx_userid", StringType(), True),
                             StructField("reqctx_userproduct", StringType(), True),
                             StructField("reqctx_userproductversion", StringType(), True),
                             StructField("reqctx_usertype", StringType(), True),
                             StructField("requestid", StringType(), True),
                             StructField("requesttype", StringType(), True),
                             StructField("response", StringType(), True),
                             StructField("result", StringType(), True),
                             StructField("results", StringType(), True),
                             StructField("returncode", StringType(), True),
                             StructField("role", StringType(), True),
                             StructField("routingnumber", StringType(), True),
                             StructField("sessionid", StringType(), True),
                             StructField("shortcode", StringType(), True),
                             StructField("sms", StringType(), True),
                             StructField("source", StringType(), True),
                             StructField("srtid", StringType(), True),
                             StructField("startdate", StringType(), True),
                             StructField("startpageoption", StringType(), True),
                             StructField("startsequence", StringType(), True),
                             StructField("state", StringType(), True),
                             StructField("statementreminder", StringType(), True),
                             StructField("statementtype", StringType(), True),
                             StructField("status", StringType(), True),
                             StructField("statusdescription", StringType(), True),
                             StructField("step", StringType(), True),
                             StructField("subuseraltid", StringType(), True),
                             StructField("subuseremail", StringType(), True),
                             StructField("subuserid", StringType(), True),
                             StructField("subusername", StringType(), True),
                             StructField("thirdpartyvendor", StringType(), True),
                             StructField("threshold", StringType(), True),
                             StructField("toaccount", StringType(), True),
                             StructField("toaccounttype", StringType(), True),
                             StructField("toroutingnumber", StringType(), True),
                             StructField("transactioncount", StringType(), True),
                             StructField("transactionlimits", StringType(), True),
                             StructField("transactiontype", StringType(), True),
                             StructField("translifespan", StringType(), True),
                             StructField("trigger", StringType(), True),
                             StructField("trnuid", StringType(), True),
                             StructField("username", StringType(), True),
                             StructField("userproduct", StringType(), True),
                             StructField("validforhostsend", StringType(), True),
                             StructField("voice", StringType(), True),
                             StructField("zip", StringType(), True),
                             StructField("channel", StringType(), True),
                             StructField("guid", StringType(), True),
                             StructField("language", StringType(), True),
                             StructField("period", StringType(), True),
                             StructField("alternatecredentialtype", StringType(), True),
                             StructField("reqctx_segmentid", StringType(), True),
                             StructField("paymentdate", StringType(), True),
                             StructField("paymentid", StringType(), True),
                             StructField("lastamount", StringType(), True),
                             StructField("payeecategory", StringType(), True),
                             StructField("businessname", StringType(), True),
                             StructField("depositstatus", StringType(), True),
                             StructField("autopayment", StringType(), True),
                             StructField("currencycode", StringType(), True),
                             StructField("accountdescriptionold", StringType(), True),
                             StructField("accountnumberold", StringType(), True),
                             StructField("achcompanyid", StringType(), True),
                             StructField("activatedflag", StringType(), True),
                             StructField("additionalinfo", StringType(), True),
                             StructField("addresstype", StringType(), True),
                             StructField("alternatecredentialalias", StringType(), True),
                             StructField("alternatecredentialid", StringType(), True),
                             StructField("amount2", StringType(), True),
                             StructField("amountsource", StringType(), True),
                             StructField("articleid", StringType(), True),
                             StructField("authorized", StringType(), True),
                             StructField("balance", StringType(), True),
                             StructField("cardstatus", StringType(), True),
                             StructField("category", StringType(), True),
                             StructField("categoryid", StringType(), True),
                             StructField("cdichallenged", StringType(), True),
                             StructField("cdimode", StringType(), True),
                             StructField("challengereason", StringType(), True),
                             StructField("commemailcontent", StringType(), True),
                             StructField("commsmscontent", StringType(), True),
                             StructField("commstatus", StringType(), True),
                             StructField("commsubject", StringType(), True),
                             StructField("countrycode", StringType(), True),
                             StructField("currencycode2", StringType(), True),
                             StructField("defaultflag", StringType(), True),
                             StructField("deletetype", StringType(), True),
                             StructField("destination", StringType(), True),
                             StructField("deviceinfo", StringType(), True),
                             StructField("devicetype", StringType(), True),
                             StructField("elapsedtime", StringType(), True),
                             StructField("emailbody", StringType(), True),
                             StructField("filist", StringType(), True),
                             StructField("filistcount", StringType(), True),
                             StructField("firecordenddate", StringType(), True),
                             StructField("firecordeventid", StringType(), True),
                             StructField("firecordeventtype", StringType(), True),
                             StructField("firecordlistcount", StringType(), True),
                             StructField("firecordstartdate", StringType(), True),
                             StructField("firstname", StringType(), True),
                             StructField("fromemail", StringType(), True),
                             StructField("fromtaxidname", StringType(), True),
                             StructField("group", StringType(), True),
                             StructField("includesreset", StringType(), True),
                             StructField("invalidattempts", StringType(), True),
                             StructField("lastname", StringType(), True),
                             StructField("layoutid", StringType(), True),
                             StructField("limit", StringType(), True),
                             StructField("mobilephonenumber", StringType(), True),
                             StructField("newmiddlename", StringType(), True),
                             StructField("oldmiddlename", StringType(), True),
                             StructField("paymenttiming", StringType(), True),
                             StructField("praccountid", StringType(), True),
                             StructField("preferencetype", StringType(), True),
                             StructField("productcode", StringType(), True),
                             StructField("productimpact", StringType(), True),
                             StructField("productrelationship", StringType(), True),
                             StructField("reqctx_customertype", StringType(), True),
                             StructField("returnmessage", StringType(), True),
                             StructField("statusafter", StringType(), True),
                             StructField("statusbefore", StringType(), True),
                             StructField("subscriptionid", StringType(), True),
                             StructField("swimlanes", StringType(), True),
                             StructField("taxidname", StringType(), True),
                             StructField("templateid", StringType(), True),
                             StructField("textbankingaccounttype", StringType(), True),
                             StructField("toaccountsuffix", StringType(), True),
                             StructField("toemail", StringType(), True),
                             StructField("totaxidname", StringType(), True),
                             StructField("totype", StringType(), True),
                             StructField("tousername", StringType(), True),
                             StructField("admintype", StringType(), True),
                             StructField("sourceuitag", StringType(), True),
                             StructField("reportname", StringType(), True),
                             StructField("filename", StringType(), True),
                             StructField("apiname", StringType(), True),
                             StructField("fraudadvice", StringType(), True),
                             StructField("riskscore", StringType(), True),
                             StructField("customtype", StringType(), True),
                             StructField("glappid", StringType(), True),
                             StructField("landingpage", StringType(), True),
                             StructField("multiplecardnumbers", StringType(), True),
                             StructField("newgroupname", StringType(), True),
                             StructField("newlivedate", StringType(), True),
                             StructField("nowtransactionid", StringType(), True),
                             StructField("oldgroupname", StringType(), True),
                             StructField("oldlivedate", StringType(), True),
                             StructField("refundnowtransactionid", StringType(), True),
                             StructField("releasename", StringType(), True),
                             StructField("templatename", StringType(), True),
                             StructField("travelitineraryid", StringType(), True),
                             StructField("travellocations", StringType(), True),
                             StructField("uniformresourcelocator", StringType(), True),
                             StructField("userexperiencetype", StringType(), True),
                             StructField("processingtime", TimestampType(), True),
                             StructField("entitytype", StringType(), True),
                             StructField("clientversion", StringType(), True),
                             StructField("entityid", StringType(), True),
                             StructField("experiencename", StringType(), True),
                             StructField("linkname", StringType(), True),
                             StructField("customlogin", StringType(), True),
                             StructField("imageuploaded", StringType(), True),
                             StructField("section", StringType(), True),
                             StructField("reqctx_homeid", StringType(), True),
                             StructField("badlogincount", StringType(), True),
                             StructField("prevbadlogincount", StringType(), True),
                             StructField("updatesection", StringType(), True),
                             StructField("errorcode", StringType(), True),
                             StructField("navaction", StringType(), True),
                             StructField("navactionname", StringType(), True),
                             StructField("oldfeaturename", StringType(), True),
                             StructField("newfeaturename", StringType(), True),
                             StructField("weburl", StringType(), True),
                             StructField("appurl", StringType(), True),
                             StructField("packagename", StringType(), True),
                             StructField("mobiletype", StringType(), True),
                             StructField("platform", StringType(), True),
                             StructField("showwhen", StringType(), True),
                             StructField("speedbump", StringType(), True),
                             StructField("newphone3", StringType(), True),
                             StructField("newphone4", StringType(), True),
                             StructField("oldphone3", StringType(), True),
                             StructField("oldphone4", StringType(), True),
                             StructField("passcode", StringType(), True),
                             StructField("brandingsection", StringType(), True),
                             StructField("brandingattribute", StringType(), True),
                             StructField("oldfeaturenamedeliverymethod", StringType(), True),
                             StructField("legacyfeaturenamemobile", StringType(), True),
                             StructField("legacyfeaturenameweb", StringType(), True),
                             StructField("addresstype1", StringType(), True),
                             StructField("addresstype2", StringType(), True),
                             StructField("newaddressvalue1", StringType(), True),
                             StructField("newvalue1", StringType(), True),
                             StructField("newvalue2", StringType(), True),
                             StructField("oldvalue1", StringType(), True),
                             StructField("oldvalue2", StringType(), True),
                             StructField("payeecount", StringType(), True),
                             StructField("defaultexperience", StringType(), True),
                             StructField("navhidden", StringType(), True),
                             StructField("navdestination", StringType(), True),
                             StructField("brandingattributevalue", StringType(), True),
                             StructField("prevbrandingattributevalue", StringType(), True),
                             StructField("externalrefid", StringType(), True),
                             StructField("entityname", StringType(), True),
                             StructField("requesttrackingid", StringType(), True),
                             StructField("providername", StringType(), True),
                             StructField("prevtemplatename", StringType(), True),
                             StructField("rules", StringType(), True),
                             StructField("prevrules", StringType(), True),
                             StructField("oldposition", StringType(), True),
                             StructField("newposition", StringType(), True),
                             StructField("sortorder", StringType(), True),
                             StructField("excludedcustomerlist", StringType(), True),
                             StructField("prevexcludedcustomerlist", StringType(), True),
                             StructField("prevenabledcustomerlist", StringType(), True),
                             StructField("enabledcustomerlist", StringType(), True),
                             StructField("externalerrorcode", StringType(), True),
                             StructField("transferspeed", StringType(), True),
                             StructField("monthlypaymentlimit", StringType(), True),
                             StructField("oldmonthlypaymentlimit", StringType(), True),
                             StructField("dailypaymentlimit", StringType(), True),
                             StructField("olddailypaymentlimit", StringType(), True),
                             StructField("transactionpaymentlimit", StringType(), True),
                             StructField("oldtransactionpaymentlimit", StringType(), True),
                             StructField("cfptype", StringType(), True),
                             StructField("supportedsizes", StringType(), True),
                             StructField("islocalized", StringType(), True),
                             StructField("isrichtext", StringType(), True),
                             StructField("isiframe", StringType(), True),
                             StructField("linkedfeatureid", StringType(), True),
                             StructField("linkedfeature", StringType(), True),
                             StructField("datelost", StringType(), True),
                             StructField("datelastused", StringType(), True),
                             StructField("reqctx_experiencename", StringType(), True),
                             StructField("reqctx_experiencegroupname", StringType(), True),
                             StructField("promotionsubscription", StringType(), True),
                             StructField("newslettersubscription", StringType(), True),
                             StructField("invalidated", StringType(), True),
                             StructField("conversionrate", StringType(), True),
                             StructField("featuretype", StringType(), True),
                             StructField("oldchildren", StringType(), True),
                             StructField("newchildren", StringType(), True),
                             StructField("lockedchildren", StringType(), True),
                             StructField("oldutilitylink", StringType(), True),
                             StructField("newutilitylink", StringType(), True),
                             StructField("oldlabels", StringType(), True),
                             StructField("newlabels", StringType(), True),
                             StructField("oldcta", StringType(), True),
                             StructField("newcta", StringType(), True),
                             StructField("newdisplayorder", StringType(), True),
                             StructField("olddisplayorder", StringType(), True),
                             StructField("accountcategory", StringType(), True),
                             StructField("documentversion", StringType(), True),
                             StructField("reqctx_canonicalid", StringType(), True)])

    elif file_type == "userbankingactivities_details":
        schema = StructType([StructField("Member", StringType(), True),
                             StructField("ReqctxCustomerType", StringType(), True),
                             StructField("Channel", StringType(), True),
                             StructField("EventDate", DateType(), True),
                             StructField("Source", StringType(), True),
                             StructField("LoginID", StringType(), True),
                             StructField("UserOS", StringType(), True),
                             StructField("MX_Transactions", LongType(), True),
                             StructField("IpayBillPay_Transactions", LongType(), True),
                             StructField("SavvyMoney_Transactions", LongType(), True),
                             StructField("Alexa_Transactions", LongType(), True),
                             StructField("PurchaseRewards_Transactions", LongType(), True),
                             StructField("FreshDesk_Transactions", LongType(), True),
                             StructField("Revation_Transactions", LongType(), True),
                             StructField("Kasisto_Transactions", LongType(), True),
                             StructField("LivePerson_Transactions", LongType(), True),
                             StructField("CardManagement_Transactions", LongType(), True),
                             StructField("FICO_Transactions", LongType(), True),
                             StructField("SkipPayment_Transactions", LongType(), True),
                             StructField("DigitalReceipt_Transactions", LongType(), True),
                             StructField("EStatement_Transactions", LongType(), True),
                             StructField("PayRailz_Transactions", LongType(), True),
                             StructField("CashEdge_Transactions", LongType(), True),
                             StructField("BBCheckPosPay_Transactions", LongType(), True),
                             StructField("BBACHPosPay_Transactions", LongType(), True),
                             StructField("BBOnlineStatement_Transactions", LongType(), True),
                             StructField("BBTPV_Transactions", LongType(), True),
                             StructField("LoanPay_Transactions", LongType(), True),
                             StructField("RDC_Transactions", LongType(), True),
                             StructField("Transfer_Transactions", LongType(), True),
                             StructField("ACH_Transactions", LongType(), True),
                             StructField("Wires_Transactions", LongType(), True),
                             StructField("BillPay_Transactions", LongType(), True),
                             StructField("Zelle_Transactions", LongType(), True),
                             StructField("TotalLogins", LongType(), True),
                             StructField("DigitalEnrollments", LongType(), True),
                             StructField("RDC_Amount", DoubleType(), True),
                             StructField("Zelle_Amount", DoubleType(), True),
                             StructField("LoanPay_Amount", DoubleType(), True),
                             StructField("Wires_Amount", DoubleType(), True),
                             StructField("ACH_Amount", DoubleType(), True),
                             StructField("Transfer_Amount", DoubleType(), True),
                             StructField("BillPay_Amount", DoubleType(), True),
                             StructField("UserGroup_Daily", StringType(), True),
                             StructField("MobileDeviceType_Daily", StringType(), True),
                             StructField("WebDeviceType_Daily", StringType(), True),
                             StructField("UserGroup_Weekly", StringType(), True),
                             StructField("MobileDeviceType_Weekly", StringType(), True),
                             StructField("WebDeviceType_Weekly", StringType(), True),
                             StructField("UserGroup_Monthly", StringType(), True),
                             StructField("MobileDeviceType_Monthly", StringType(), True),
                             StructField("WebDeviceType_Monthly", StringType(), True),
                             StructField("UserGroup_Quarterly", StringType(), True),
                             StructField("MobileDeviceType_Quarterly", StringType(), True),
                             StructField("WebDeviceType_Quarterly", StringType(), True),
                             StructField("MX_ActiveUser_Daily", StringType(), True),
                             StructField("IpayBillPay_ActiveUser_Daily", StringType(), True),
                             StructField("SavvyMoney_ActiveUser_Daily", StringType(), True),
                             StructField("Alexa_ActiveUser_Daily", StringType(), True),
                             StructField("PurchaseRewards_ActiveUser_Daily", StringType(), True),
                             StructField("FreshDesk_ActiveUser_Daily", StringType(), True),
                             StructField("Revation_ActiveUser_Daily", StringType(), True),
                             StructField("Kasisto_ActiveUser_Daily", StringType(), True),
                             StructField("LivePerson_ActiveUser_Daily", StringType(), True),
                             StructField("CardManagement_ActiveUser_Daily", StringType(), True),
                             StructField("FICO_ActiveUser_Daily", StringType(), True),
                             StructField("SkipPayment_ActiveUser_Daily", StringType(), True),
                             StructField("DigitalReceipt_ActiveUser_Daily", StringType(), True),
                             StructField("EStatement_ActiveUser_Daily", StringType(), True),
                             StructField("PayRailz_ActiveUser_Daily", StringType(), True),
                             StructField("CashEdge_ActiveUser_Daily", StringType(), True),
                             StructField("BBCheckPosPay_ActiveUser_Daily", StringType(), True),
                             StructField("BBACHPosPay_ActiveUser_Daily", StringType(), True),
                             StructField("BBOnlineStatement_ActiveUser_Daily", StringType(), True),
                             StructField("BBTPV_ActiveUser_Daily", StringType(), True),
                             StructField("TotalProductsUsed_Daily", LongType(), True),
                             StructField("LoanPay_ActiveUser_Daily", StringType(), True),
                             StructField("RDC_ActiveUser_Daily", StringType(), True),
                             StructField("Transfer_ActiveUser_Daily", StringType(), True),
                             StructField("ACH_ActiveUser_Daily", StringType(), True),
                             StructField("Wires_ActiveUser_Daily", StringType(), True),
                             StructField("BillPay_ActiveUser_Daily", StringType(), True),
                             StructField("Zelle_ActiveUser_Daily", StringType(), True),
                             StructField("TotalProductsNMUsed_Daily", LongType(), True),
                             StructField("MX_ActiveUser_Weekly", StringType(), True),
                             StructField("IpayBillPay_ActiveUser_Weekly", StringType(), True),
                             StructField("SavvyMoney_ActiveUser_Weekly", StringType(), True),
                             StructField("Alexa_ActiveUser_Weekly", StringType(), True),
                             StructField("PurchaseRewards_ActiveUser_Weekly", StringType(), True),
                             StructField("FreshDesk_ActiveUser_Weekly", StringType(), True),
                             StructField("Revation_ActiveUser_Weekly", StringType(), True),
                             StructField("Kasisto_ActiveUser_Weekly", StringType(), True),
                             StructField("LivePerson_ActiveUser_Weekly", StringType(), True),
                             StructField("CardManagement_ActiveUser_Weekly", StringType(), True),
                             StructField("FICO_ActiveUser_Weekly", StringType(), True),
                             StructField("SkipPayment_ActiveUser_Weekly", StringType(), True),
                             StructField("DigitalReceipt_ActiveUser_Weekly", StringType(), True),
                             StructField("EStatement_ActiveUser_Weekly", StringType(), True),
                             StructField("PayRailz_ActiveUser_Weekly", StringType(), True),
                             StructField("CashEdge_ActiveUser_Weekly", StringType(), True),
                             StructField("BBCheckPosPay_ActiveUser_Weekly", StringType(), True),
                             StructField("BBACHPosPay_ActiveUser_Weekly", StringType(), True),
                             StructField("BBOnlineStatement_ActiveUser_Weekly", StringType(), True),
                             StructField("BBTPV_ActiveUser_Weekly", StringType(), True),
                             StructField("TotalProductsUsed_Weekly", LongType(), True),
                             StructField("LoanPay_ActiveUser_Weekly", StringType(), True),
                             StructField("RDC_ActiveUser_Weekly", StringType(), True),
                             StructField("Transfer_ActiveUser_Weekly", StringType(), True),
                             StructField("ACH_ActiveUser_Weekly", StringType(), True),
                             StructField("Wires_ActiveUser_Weekly", StringType(), True),
                             StructField("BillPay_ActiveUser_Weekly", StringType(), True),
                             StructField("Zelle_ActiveUser_Weekly", StringType(), True),
                             StructField("TotalProductsNMUsed_Weekly", LongType(), True),
                             StructField("MX_ActiveUser_Monthly", StringType(), True),
                             StructField("IpayBillPay_ActiveUser_Monthly", StringType(), True),
                             StructField("SavvyMoney_ActiveUser_Monthly", StringType(), True),
                             StructField("Alexa_ActiveUser_Monthly", StringType(), True),
                             StructField("PurchaseRewards_ActiveUser_Monthly", StringType(), True),
                             StructField("FreshDesk_ActiveUser_Monthly", StringType(), True),
                             StructField("Revation_ActiveUser_Monthly", StringType(), True),
                             StructField("Kasisto_ActiveUser_Monthly", StringType(), True),
                             StructField("LivePerson_ActiveUser_Monthly", StringType(), True),
                             StructField("CardManagement_ActiveUser_Monthly", StringType(), True),
                             StructField("FICO_ActiveUser_Monthly", StringType(), True),
                             StructField("SkipPayment_ActiveUser_Monthly", StringType(), True),
                             StructField("DigitalReceipt_ActiveUser_Monthly", StringType(), True),
                             StructField("EStatement_ActiveUser_Monthly", StringType(), True),
                             StructField("PayRailz_ActiveUser_Monthly", StringType(), True),
                             StructField("CashEdge_ActiveUser_Monthly", StringType(), True),
                             StructField("BBCheckPosPay_ActiveUser_Monthly", StringType(), True),
                             StructField("BBACHPosPay_ActiveUser_Monthly", StringType(), True),
                             StructField("BBOnlineStatement_ActiveUser_Monthly", StringType(), True),
                             StructField("BBTPV_ActiveUser_Monthly", StringType(), True),
                             StructField("TotalProductsUsed_Monthly", LongType(), True),
                             StructField("LoanPay_ActiveUser_Monthly", StringType(), True),
                             StructField("RDC_ActiveUser_Monthly", StringType(), True),
                             StructField("Transfer_ActiveUser_Monthly", StringType(), True),
                             StructField("ACH_ActiveUser_Monthly", StringType(), True),
                             StructField("Wires_ActiveUser_Monthly", StringType(), True),
                             StructField("BillPay_ActiveUser_Monthly", StringType(), True),
                             StructField("Zelle_ActiveUser_Monthly", StringType(), True),
                             StructField("TotalProductsNMUsed_Monthly", LongType(), True),
                             StructField("MX_ActiveUser_Quarterly", StringType(), True),
                             StructField("IpayBillPay_ActiveUser_Quarterly", StringType(), True),
                             StructField("SavvyMoney_ActiveUser_Quarterly", StringType(), True),
                             StructField("Alexa_ActiveUser_Quarterly", StringType(), True),
                             StructField("PurchaseRewards_ActiveUser_Quarterly", StringType(), True),
                             StructField("FreshDesk_ActiveUser_Quarterly", StringType(), True),
                             StructField("Revation_ActiveUser_Quarterly", StringType(), True),
                             StructField("Kasisto_ActiveUser_Quarterly", StringType(), True),
                             StructField("LivePerson_ActiveUser_Quarterly", StringType(), True),
                             StructField("CardManagement_ActiveUser_Quarterly", StringType(), True),
                             StructField("FICO_ActiveUser_Quarterly", StringType(), True),
                             StructField("SkipPayment_ActiveUser_Quarterly", StringType(), True),
                             StructField("DigitalReceipt_ActiveUser_Quarterly", StringType(), True),
                             StructField("EStatement_ActiveUser_Quarterly", StringType(), True),
                             StructField("PayRailz_ActiveUser_Quarterly", StringType(), True),
                             StructField("CashEdge_ActiveUser_Quarterly", StringType(), True),
                             StructField("BBCheckPosPay_ActiveUser_Quarterly", StringType(), True),
                             StructField("BBACHPosPay_ActiveUser_Quarterly", StringType(), True),
                             StructField("BBOnlineStatement_ActiveUser_Quarterly", StringType(), True),
                             StructField("BBTPV_ActiveUser_Quarterly", StringType(), True),
                             StructField("TotalProductsUsed_Quarterly", LongType(), True),
                             StructField("LoanPay_ActiveUser_Quarterly", StringType(), True),
                             StructField("RDC_ActiveUser_Quarterly", StringType(), True),
                             StructField("Transfer_ActiveUser_Quarterly", StringType(), True),
                             StructField("ACH_ActiveUser_Quarterly", StringType(), True),
                             StructField("Wires_ActiveUser_Quarterly", StringType(), True),
                             StructField("BillPay_ActiveUser_Quarterly", StringType(), True),
                             StructField("Zelle_ActiveUser_Quarterly", StringType(), True),
                             StructField("TotalProductsNMUsed_Quarterly", LongType(), True),
                             StructField("ActiveUser", StringType(), True),
                             StructField("CountyFIPSCode", StringType(), True),
                             StructField("StateName", StringType(), True),
                             StructField("FI_ID", StringType(), True)])

    elif file_type == "acct":
        schema = StructType([StructField("ACCTNBR", LongType(), True),
                             StructField("STMTACCTNBR", LongType(), True),
                             StructField("HOLDACCTNBR", LongType(), True),
                             StructField("HOLDSUBACCTNBR", LongType(), True),
                             StructField("VALIDYN", StringType(), True),
                             StructField("TAXRPTFOROWNYN", StringType(), True),
                             StructField("TAXRPTFORSIGYN", StringType(), True),
                             StructField("RETIREMENTYN", StringType(), True),
                             StructField("MJACCTTYPCD", StringType(), True),
                             StructField("CURRMIACCTTYPCD", StringType(), True),
                             StructField("CURRACCTSTATCD", StringType(), True),
                             StructField("MAILTYPCD", StringType(), True),
                             StructField("MAILADDRUSECD", StringType(), True),
                             StructField("OPENFUNDSOURCECD", StringType(), True),
                             StructField("OWNCD", StringType(), True),
                             StructField("OVRDELIVERYMETHCD", StringType(), True),
                             StructField("DATELASTCONTACT", TimestampType(), True),
                             StructField("DATEMAT", TimestampType(), True),
                             StructField("TAXRPTFORORGNBR", LongType(), True),
                             StructField("TAXRPTFORPERSNBR", LongType(), True),
                             StructField("BRANCHORGNBR", LongType(), True),
                             StructField("BANKORGNBR", LongType(), True),
                             StructField("NEXTSUBNBR", LongType(), True),
                             StructField("NEXTRTXNNBR", LongType(), True),
                             StructField("NEXTSTOPPMTREQNBR", LongType(), True),
                             StructField("DATELASTMAINT", TimestampType(), True),
                             StructField("CLOSEREASONCD", StringType(), True),
                             StructField("NEXTBANKCHECKNBR", DecimalType(38, 18), True),
                             StructField("PASSBOOKYN", StringType(), True),
                             StructField("ACCTDESC", StringType(), True),
                             StructField("ADDRFORMATCD", StringType(), True),
                             StructField("RPT1098YN", StringType(), True),
                             StructField("RPTPTSYN", StringType(), True),
                             StructField("CURRTERM", DecimalType(38, 18), True),
                             StructField("CONTRACTDATE", TimestampType(), True),
                             StructField("TRANSACTIONACCTYN", StringType(), True),
                             StructField("STMTACCTYN", StringType(), True),
                             StructField("ASSIGNEDACCTNBR", IntegerType(), True),
                             StructField("ANALYSISYN", StringType(), True),
                             StructField("MEMBERAGREENBR", IntegerType(), True),
                             StructField("NCUACATCD", StringType(), True),
                             StructField("MAXOVERDRAFTLIMIT", FloatType(), True),
                             StructField("NEXTPPAYITEMNBR", DecimalType(38, 18), True),
                             StructField("ACCTPPAYYN", StringType(), True),
                             StructField("DATECONVERTED", TimestampType(), True),
                             StructField("DRAWYN", StringType(), True),
                             StructField("HSASRCCD", StringType(), True),
                             StructField("ESCHEATYN", StringType(), True),
                             StructField("ESCHEATDATE", TimestampType(), True),
                             StructField("ACTIVEACCTCLASSNBR", DecimalType(38, 18), True),
                             StructField("STANDARDACCTCLASSNBR", DecimalType(38, 18), True),
                             StructField("ORIGTERM", DecimalType(38, 18), True),
                             StructField("LASTRTXNPURGETODATE", TimestampType(), True),
                             StructField("LASTUPDATED", TimestampType(), True),
                             StructField("DELETED", BooleanType(), True)])

    elif file_type == "acctacctroleorg":
        schema = StructType([StructField("ACCTNBR", LongType(), True),
                             StructField("ACCTROLECD", StringType(), True),
                             StructField("EFFDATE", TimestampType(), True),
                             StructField("ORGNBR", LongType(), True),
                             StructField("INACTIVEDATE", TimestampType(), True),
                             StructField("DATELASTMAINT", TimestampType(), True),
                             StructField("LOANLBLTYPCT", IntegerType(), True),
                             StructField("LOANLBLTYAMT", IntegerType(), True),
                             StructField("LASTUPDATED", TimestampType(), True),
                             StructField("DELETED", BooleanType(), True)])

    elif file_type == "acctacctrolepers":
        schema = StructType([StructField("ACCTNBR", LongType(), True),
                             StructField("ACCTROLECD", StringType(), True),
                             StructField("EFFDATE", TimestampType(), True),
                             StructField("PERSNBR", LongType(), True),
                             StructField("INACTIVEDATE", TimestampType(), True),
                             StructField("DATELASTMAINT", TimestampType(), True),
                             StructField("LOANLBLTYPCT", DecimalType(38, 18), True),
                             StructField("LOANLBLTYAMT", DecimalType(38, 18), True),
                             StructField("LASTUPDATED", TimestampType(), True),
                             StructField("DELETED", BooleanType(), True)])

    elif file_type == "acctbalhist":
        schema = StructType([StructField("ACCTNBR", LongType(), True),
                             StructField("SUBACCTNBR", LongType(), True),
                             StructField("EFFDATE", TimestampType(), True),
                             StructField("BALAMT", DecimalType(38, 18), True),
                             StructField("DATELASTMAINT", TimestampType(), True),
                             StructField("LASTUPDATED", TimestampType(), True)])

    elif file_type == "mjmiaccttyp":
        schema = StructType([StructField("MJACCTTYPCD", StringType(), True),
                             StructField("MIACCTTYPCD", StringType(), True),
                             StructField("MIACCTTYPDESC", StringType(), True),
                             StructField("DELIVERYMETHCD", StringType(), True),
                             StructField("PMTSPDCD", StringType(), True),
                             StructField("SLPCD", StringType(), True),
                             StructField("PMTMETHCD", StringType(), True),
                             StructField("PMTCALPERIODCD", StringType(), True),
                             StructField("BILLINGLEADDAYS", IntegerType(), True),
                             StructField("RPTDEFERINTYN", StringType(), True),
                             StructField("EXCESSTXNYN", StringType(), True),
                             StructField("PASSBOOKYN", StringType(), True),
                             StructField("CHECKSYN", StringType(), True),
                             StructField("TXNACCTYN", StringType(), True),
                             StructField("CANDRAWFROMYN", StringType(), True),
                             StructField("STMTYN", StringType(), True),
                             StructField("COLLINTYN", StringType(), True),
                             StructField("MINLOANAMT", LongType(), True),
                             StructField("MAXLOANAMT", LongType(), True),
                             StructField("MAXOVERDRAFTAMT", LongType(), True),
                             StructField("MINDRAWAMT", LongType(), True),
                             StructField("MINSWEEPAMT", LongType(), True),
                             StructField("RNEWGRACEDAYS", IntegerType(), True),
                             StructField("ADDTDEPYN", StringType(), True),
                             StructField("ADDTDEPGRACEDAYS", IntegerType(), True),
                             StructField("ADDTDEPMATEXTENYN", StringType(), True),
                             StructField("RNEWMIACCTTYPCD", StringType(), True),
                             StructField("MINTERMDAYS", IntegerType(), True),
                             StructField("MAXTERMDAYS", IntegerType(), True),
                             StructField("DEFAULTTERMDAYS", IntegerType(), True),
                             StructField("GRACEDAYS", IntegerType(), True),
                             StructField("DEFAULTDUEDAY", IntegerType(), True),
                             StructField("DATELASTMAINT", TimestampType(), True),
                             StructField("REVOLVELOANYN", StringType(), True),
                             StructField("DISPLAYSEQNBR", IntegerType(), True),
                             StructField("MAXCOUPONCOUNT", IntegerType(), True),
                             StructField("INACTIVEDATE", TimestampType(), True),
                             StructField("VALIDYN", StringType(), True),
                             StructField("EFFDATE", TimestampType(), True),
                             StructField("RCVBGENMETHCD", StringType(), True),
                             StructField("PMTOVRYN", StringType(), True),
                             StructField("BILLADVANCEYN", StringType(), True),
                             StructField("PREPAYMENTALLOWEDYN", StringType(), True),
                             StructField("DEFAULTCREDITLIMIT", IntegerType(), True),
                             StructField("DRAWINCRAMT", IntegerType(), True),
                             StructField("PRIMARYSTMTYN", StringType(), True),
                             StructField("SECONDARYSTMTYN", StringType(), True),
                             StructField("SWEEPFROMYN", StringType(), True),
                             StructField("SWEEPTOYN", StringType(), True),
                             StructField("SWEEPMGMTYN", StringType(), True),
                             StructField("DRAWBALGOALAMT", IntegerType(), True),
                             StructField("ACCTOVRPSBKYN", StringType(), True),
                             StructField("RATECHANGELEADDAYS", IntegerType(), True),
                             StructField("PMTCHANGELEADDAYS", IntegerType(), True),
                             StructField("MINBAL", IntegerType(), True),
                             StructField("MINDEPAMT", IntegerType(), True),
                             StructField("MINWTHAMT", IntegerType(), True),
                             StructField("RPT1098YN", StringType(), True),
                             StructField("RPTPTSYN", StringType(), True),
                             StructField("ACCRTHRUDUEDATEYN", StringType(), True),
                             StructField("DEMANDYN", StringType(), True),
                             StructField("LETTEROFCREDITTYPCD", StringType(), True),
                             StructField("LOANLIMITYN", StringType(), True),
                             StructField("ADDTDISBYN", StringType(), True),
                             StructField("CREDITREPORTTYPCD", StringType(), True),
                             StructField("CUSHIONMONTHS", IntegerType(), True),
                             StructField("PARTIALPMTALLOWEDYN", StringType(), True),
                             StructField("PASSBOOKLOANYN", StringType(), True),
                             StructField("BALLOONYN", StringType(), True),
                             StructField("LOANLOSSCATCD", StringType(), True),
                             StructField("MICUSTDESC", StringType(), True),
                             StructField("RATECHANGERECALCPMTYN", StringType(), True),
                             StructField("PMTCALCINCLUDEODDDAYSYN", StringType(), True),
                             StructField("INACTIVEDAYS", IntegerType(), True),
                             StructField("DORMANTDAYS", IntegerType(), True),
                             StructField("TRUNCATEYN", StringType(), True),
                             StructField("ANNUALCOST", IntegerType(), True),
                             StructField("MMYN", StringType(), True),
                             StructField("RTMTPLANTYPCD", StringType(), True),
                             StructField("RTMTPLANCATCD", StringType(), True),
                             StructField("ODDDAYSMETHCD", StringType(), True),
                             StructField("NONACCRUALDAYS", IntegerType(), True),
                             StructField("MASTERLINEYN", StringType(), True),
                             StructField("CRACATCD", StringType(), True),
                             StructField("CURRENCYCD", StringType(), True),
                             StructField("NCUACATCD", StringType(), True),
                             StructField("ALLOWSCTODRAWNEGYN", StringType(), True),
                             StructField("CONSTLOANALLOWEDYN", StringType(), True),
                             StructField("DEFAULTCONSTPROJTYPCD", StringType(), True),
                             StructField("ALLOWMEMODEPOSITYN", StringType(), True),
                             StructField("MAXPREPMTSALLOWED", IntegerType(), True),
                             StructField("NONRESPAYN", StringType(), True),
                             StructField("ESCPMTRNDMETHCD", StringType(), True),
                             StructField("ALLOTPAYOFFYN", StringType(), True),
                             StructField("FUTURERCVBYN", StringType(), True),
                             StructField("PAYVALIDYN", StringType(), True),
                             StructField("PARTICIPATIONYN", StringType(), True),
                             StructField("ALLOWACCTPPAYYN", StringType(), True),
                             StructField("PREPAYWITHLATECHGFIRSTYN", StringType(), True),
                             StructField("DESCTOKENNBR", IntegerType(), True),
                             StructField("RNEWALLOWEDYN", StringType(), True),
                             StructField("RNEWPMTTERM", IntegerType(), True),
                             StructField("MAXBAL", IntegerType(), True),
                             StructField("UNSCHEDPRINPMTSALLOWEDYN", StringType(), True),
                             StructField("ALLOWNEGBALACCRUALYN", StringType(), True),
                             StructField("SINGLEACCTODPROCYN", StringType(), True),
                             StructField("FCYCHKYN", StringType(), True),
                             StructField("ALTPMTDUEDAYNBR", IntegerType(), True),
                             StructField("DESCNAMESPACECD", StringType(), True),
                             StructField("DRAWFROMACCTOVRDYN", StringType(), True),
                             StructField("OVRDDRAWINCRYN", StringType(), True),
                             StructField("CALCANNIVERSARYACCRUALYN", StringType(), True),
                             StructField("EXCLUDEBILLPAYYN", StringType(), True),
                             StructField("LOANMATNOTICELEADDAYS", IntegerType(), True),
                             StructField("INTFIRSTPROCYN", StringType(), True),
                             StructField("INTFIRSTINTONLYTERM", IntegerType(), True),
                             StructField("INTFIRSTFUTURELEADDAYS", IntegerType(), True),
                             StructField("MAXUNCOLLECTEDAMT", IntegerType(), True),
                             StructField("CLUBYN", StringType(), True),
                             StructField("ALLOWMULTIDUEDATESYN", StringType(), True),
                             StructField("NOSTROINSTLEVELYN", StringType(), True),
                             StructField("SWIFTREPORTYN", StringType(), True),
                             StructField("STANDARDACCTCLASSNBR", IntegerType(), True),
                             StructField("NEWACCTACCTCLASSNBR", IntegerType(), True),
                             StructField("FLOATSEQNBR", IntegerType(), True),
                             StructField("USEFORFLOATYN", StringType(), True),
                             StructField("LIMITAMTREDUCESAVAILYN", StringType(), True),
                             StructField("LNADVTODTREDUCESREVOLVAVAILYN", StringType(), True),
                             StructField("ALLOWPRINSURPLUSPROCYN", StringType(), True),
                             StructField("FUTUREMIACCTTYPCD", StringType(), True)])

    elif file_type == "org":
        schema = StructType([StructField("ORGNBR", LongType(), True),
                             StructField("PARENTORGNBR", LongType(), True),
                             StructField("ORGNAME", StringType(), True),
                             StructField("ORGNAMESNDX", StringType(), True),
                             StructField("ORGTYPCD", StringType(), True),
                             StructField("VALIDYN", StringType(), True),
                             StructField("CURRROUTENBR", IntegerType(), True),
                             StructField("ADDDATE", TimestampType(), True),
                             StructField("DATELASTMAINT", TimestampType(), True),
                             StructField("RPT1099INTYN", StringType(), True),
                             StructField("FRGNCERTEXPDATE", TimestampType(), True),
                             StructField("PRIVACYYN", StringType(), True),
                             StructField("TAXEXEMPTYN", StringType(), True),
                             StructField("PURGEYN", StringType(), True),
                             StructField("MAILTYPCD", StringType(), True),
                             StructField("SWIFTBRANCHYN", StringType(), True),
                             StructField("SWIFTADDR", StringType(), True),
                             StructField("PREFCULTURECD", StringType(), True),
                             StructField("CTRLPERSNBR", LongType(), True)])

    elif file_type == "orguserfield":
        schema = StructType([StructField("ORGNBR", LongType(), True),
                             StructField("USERFIELDCD", StringType(), True),
                             StructField("VALUE", StringType(), True),
                             StructField("DATELASTMAINT", TimestampType(), True),
                             StructField("VALUELASTUPDATEDDATE", TimestampType(), True),
                             StructField("LASTUPDATED", TimestampType(), True)])

    elif file_type == "pers":
        schema = StructType([StructField("PERSNBR", LongType(), True),
                             StructField("SPOUSEPERSNBR", LongType(), True),
                             StructField("RESTAXCTRYCD", StringType(), True),
                             StructField("CRCD", StringType(), True),
                             StructField("SALUCD", StringType(), True),
                             StructField("LASTNAME", StringType(), True),
                             StructField("LASTNAMESNDX", StringType(), True),
                             StructField("FIRSTNAME", StringType(), True),
                             StructField("FIRSTNAMESNDX", StringType(), True),
                             StructField("MDLINIT", StringType(), True),
                             StructField("MDLNAME", StringType(), True),
                             StructField("NICKNAME", StringType(), True),
                             StructField("SUFFIX", StringType(), True),
                             StructField("TAXID", IntegerType(), True),
                             StructField("ADDDATE", TimestampType(), True),
                             StructField("DATEBIRTH", TimestampType(), True),
                             StructField("DATEDEATH", TimestampType(), True),
                             StructField("DATETAXIDAPPLY", TimestampType(), True),
                             StructField("DATETAXCERT", TimestampType(), True),
                             StructField("EDUCLEVCD", StringType(), True),
                             StructField("INCOMELEVCD", StringType(), True),
                             StructField("NBRDEPND", LongType(), True),
                             StructField("OCCPTNCD", StringType(), True),
                             StructField("MAILTYPCD", StringType(), True),
                             StructField("OWNRENT", StringType(), True),
                             StructField("CUSTKEYWORD", StringType(), True),
                             StructField("VALIDYN", StringType(), True),
                             StructField("DATELASTMAINT", TimestampType(), True),
                             StructField("FRGNCERTEXPDATE", TimestampType(), True),
                             StructField("LASTNAMEUPPER", StringType(), True),
                             StructField("FIRSTNAMEUPPER", StringType(), True),
                             StructField("RPT1042SYN", StringType(), True),
                             StructField("GRADDATE", TimestampType(), True),
                             StructField("CREDITREPORTCONSINFOCD", StringType(), True),
                             StructField("PRIVACYYN", StringType(), True),
                             StructField("PURGEYN", StringType(), True),
                             StructField("SHORTNAME", StringType(), True),
                             StructField("PREFCULTURECD", StringType(), True),
                             StructField("SECONDSURNAME", StringType(), True),
                             StructField("LASTUPDATED", TimestampType(), True)])

    elif file_type == "persuserfield":
        schema = StructType([StructField("PERSNBR", LongType(), True),
                             StructField("USERFIELDCD", StringType(), True),
                             StructField("VALUE", StringType(), True),
                             StructField("DATELASTMAINT", TimestampType(), True),
                             StructField("VALUELASTUPDATEDDATE", TimestampType(), True),
                             StructField("LASTUPDATED", TimestampType(), True)])

    elif file_type == "rtxn":
        schema = StructType([StructField("ACCTNBR", LongType(), True),
                             StructField("RTXNNBR", DecimalType(38, 18), True),
                             StructField("PARENTACCTNBR", LongType(), True),
                             StructField("PARENTRTXNNBR", DecimalType(38, 18), True),
                             StructField("QUENBR", DecimalType(38, 18), True),
                             StructField("APPLNBR", DecimalType(38, 18), True),
                             StructField("RTMTTXNCATCD", StringType(), True),
                             StructField("ALLOTSUBACCTNBR", DecimalType(38, 18), True),
                             StructField("ALLOTNBR", DecimalType(38, 18), True),
                             StructField("RTXNTYPCD", StringType(), True),
                             StructField("EXTRTXNDESCNBR", DecimalType(38, 18), True),
                             StructField("INTRRTXNDESCNBR", DecimalType(38, 18), True),
                             StructField("INITIALCARDNBR", IntegerType(), True),
                             StructField("QUESUBNBR", DecimalType(38, 18), True),
                             StructField("RTMTYR", DecimalType(38, 18), True),
                             StructField("NOTENBR", DecimalType(38, 18), True),
                             StructField("HOLDACCTNBR", LongType(), True),
                             StructField("HOLDSUBACCTNBR", DecimalType(38, 18), True),
                             StructField("CHECKNBR", DecimalType(38, 18), True),
                             StructField("TRACENBR", StringType(), True),
                             StructField("DATELASTMAINT", TimestampType(), True),
                             StructField("CURRRTXNSTATCD", StringType(), True),
                             StructField("TRANAMT", DecimalType(38, 18), True),
                             StructField("ORIGPOSTDATE", TimestampType(), True),
                             StructField("REVERSALRTXNNBR", DecimalType(38, 18), True),
                             StructField("OFFLINEDATETIME", TimestampType(), True),
                             StructField("OFFLINESEQNBR", DecimalType(38, 18), True),
                             StructField("REENTRYPERSNBR", LongType(), True),
                             StructField("REENTRYNTWKNODENBR", DecimalType(38, 18), True),
                             StructField("ALLOTINSTANCENBR", DecimalType(38, 18), True),
                             StructField("RTXNSOURCECD", StringType(), True),
                             StructField("RTXNREASONCD", StringType(), True),
                             StructField("REGDYN", StringType(), True),
                             StructField("RTXNAUXNBR", DecimalType(38, 18), True),
                             StructField("COBYN", StringType(), True),
                             StructField("ONLCHKTRACENBR", DecimalType(38, 18), True),
                             StructField("OTCPERSNBR", LongType(), True),
                             StructField("RTMTCONTRIBQUALIFIERCD", StringType(), True),
                             StructField("RTXNREVERSALREASONCD", StringType(), True),
                             StructField("WAIVEAPPRPERSNBR", LongType(), True),
                             StructField("LastUpdated", TimestampType(), True)])

    elif file_type == "rtxntyp":
        schema = StructType([StructField("RTXNTYPCD", StringType(), True),
                             StructField("RTXNTYPDESC", StringType(), True),
                             StructField("RTXNTYPCATCD", StringType(), True),
                             StructField("UPDLASTCONTACTYN", StringType(), True),
                             StructField("PAIDINYN", StringType(), True),
                             StructField("DATELASTMAINT", TimestampType(), True),
                             StructField("JEFUNDTYPYN", StringType(), True),
                             StructField("YTDTYPCD", StringType(), True),
                             StructField("ALLOWASGENRTXNYN", StringType(), True),
                             StructField("PRIORYEARYN", StringType(), True),
                             StructField("CUSTVIEWYN", StringType(), True),
                             StructField("BALCATTYPYTDTYPYN", StringType(), True),
                             StructField("EXCESSTXNYN", StringType(), True),
                             StructField("GLRPTYN", StringType(), True),
                             StructField("ALLOWSWIMYN", StringType(), True),
                             StructField("DEFAULTFUNDTYPCD", StringType(), True),
                             StructField("DEFAULTCLEARCATCD", StringType(), True),
                             StructField("DEFAULTFUNDTYPDTLCD", StringType(), True),
                             StructField("UPDATELSECAMTYN", StringType(), True),
                             StructField("PARTICIPATIONYN", StringType(), True),
                             StructField("ALLOWTELLERTXNLIMITAMTYN", StringType(), True),
                             StructField("DESCTOKENNBR", StringType(), True),
                             StructField("SHOWANLYSCYN", StringType(), True),
                             StructField("DESCNAMESPACECD", StringType(), True),
                             StructField("AUTHITEMCD", StringType(), True),
                             StructField("RCPTREQUIRESSIGYN", StringType(), True),
                             StructField("PRINTSEQNBR", StringType(), True),
                             StructField("INTRTXNDESCREQDONLINEYN", StringType(), True),
                             StructField("BUSOBJCLASSNAME", StringType(), True)])

    else:
        raise "Invalid option - " + file_type

    return schema


def main():
    tmp_py_file_path, input_bucket, file_nm, pipeline_type, output_bucket_prefix = [ele for ele in sys.argv]
    print("Arguments received:" + str(sys.argv))

    date_part = file_nm.split("/")[-2]
    file_type = ""
    if pipeline_type == "minerva":
        file_type = file_nm.split("/")[-4].lower()
    else:
        file_type = file_nm.split("/")[-3].lower()

    spark = _create_spark(pipeline_type + "-spark-app")
    schema = _get_schema(file_type)

    # Below code will be removed eventually , as the plan is to merge the output buckets into one.
    if file_type == 'badlogin_details': file_type = "bdlgn"
    if file_type == 'clickstreampageviewaggregate': file_type = "cspv"
    if file_type == 'consolidatedproductpivot': file_type = "cpp"
    if file_type == 'consolidateduserdim': file_type = "cud"
    if file_type == 'consolidatedvisitmetrics': file_type = "cvm"
    if file_type == 'firewallsummarymetrics': file_type = "fsm"
    if file_type == 'securityfirewallrulemetrics': file_type = "sfrm"
    if file_type == 'securityipaddressmetrics': file_type = "sim"
    if file_type == 'securitysummarymetrics': file_type = "ssm"
    if file_type == 'totalusers': file_type = "tu"
    if file_type == 'userbankingactivities_details': file_type = "ubad"
    if file_type == 'cloudflare_logs': file_type = "cfl"
    if file_type == 'dw_bp_mth_fis': file_type = "dpmf"
    if file_type == 'dw_bp_mth_fiserv': file_type = "dpmfv"
    if file_type == 'rpt_user_profile': file_type = "rup"
    if file_type == 'system_banking_activity': file_type = "sba"
    if file_type == 'user_banking_activity': file_type = "uba"
    if file_type == 'acctacctroleorg': file_type = "aaro"
    if file_type == 'acctacctrolepers': file_type = "aacrp"
    if file_type == 'acctbalhist': file_type = "abh"
    if file_type == 'mjmiaccttyp': file_type = "mat"
    if file_type == 'orguserfield': file_type = "ouf"
    if file_type == 'persuserfield': file_type = "puf"
    if file_type == 'rtxntyp': file_type = "rt"

    output_storage_bucket = output_bucket_prefix + pipeline_type + "-" + file_type + "/"

    print("Creating Dataframe")
    df = spark \
        .read \
        .schema(schema) \
        .parquet("gs://" + input_bucket + "/" + file_nm)

    print("Writing file - " + pipeline_type + file_type + "_" + date_part)
    df.write \
        .mode("overwrite") \
        .parquet(output_storage_bucket + "/" + pipeline_type + file_type + "_" + date_part)

    # temporarily added for ongoing development and testing
    df.show()


if __name__ == "__main__":
    try:
        main()
        print("Spark application is complete")

    except Exception as err:
        print("Spark application has failed with error - " + str(err))
        raise
